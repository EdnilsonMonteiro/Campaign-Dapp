(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73],{8216:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/campaigns/requests",function(){return r(2601)}])},2601:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return I}});var n=r(7568),s=r(1438),a=r(2951),l=r(8029),i=r(460),c=r(655),o=r(5893),d=r(7294),u=r(7462),p=r(3871),h=r(6010),v=r(8459),f=r(8935),g=r(2519),m=r(2248);function Z(e){var t=e.children,r=e.className,n=(0,h.Z)(r),s=(0,f.Z)(Z,e),a=(0,g.Z)(Z,e);return d.createElement(a,(0,u.Z)({},s,{className:n}),t)}Z.handledProps=["as","children","className"],Z.defaultProps={as:"tbody"},Z.propTypes={};var x=Z,b=r(9591),w=r(5150);function j(e){var t=e.active,r=e.children,n=e.className,s=e.collapsing,a=e.content,l=e.disabled,i=e.error,c=e.icon,o=e.negative,p=e.positive,Z=e.selectable,x=e.singleLine,b=e.textAlign,A=e.verticalAlign,k=e.warning,G=e.width,y=(0,h.Z)((0,v.lG)(t,"active"),(0,v.lG)(s,"collapsing"),(0,v.lG)(l,"disabled"),(0,v.lG)(i,"error"),(0,v.lG)(o,"negative"),(0,v.lG)(p,"positive"),(0,v.lG)(Z,"selectable"),(0,v.lG)(x,"single line"),(0,v.lG)(k,"warning"),(0,v.X4)(b),(0,v.Ok)(A),(0,v.H0)(G,"wide"),n),N=(0,f.Z)(j,e),_=(0,g.Z)(j,e);return m.kK(r)?d.createElement(_,(0,u.Z)({},N,{className:y}),w.Z.create(c),a):d.createElement(_,(0,u.Z)({},N,{className:y}),r)}j.handledProps=["active","as","children","className","collapsing","content","disabled","error","icon","negative","positive","selectable","singleLine","textAlign","verticalAlign","warning","width"],j.defaultProps={as:"td"},j.propTypes={},j.create=(0,b.u5)(j,(function(e){return{content:e}}));var A=j;function k(e){var t=e.children,r=e.className,n=e.content,s=e.fullWidth,a=(0,h.Z)((0,v.lG)(s,"full-width"),r),l=(0,f.Z)(k,e),i=(0,g.Z)(k,e);return d.createElement(i,(0,u.Z)({},l,{className:a}),m.kK(t)?n:t)}k.handledProps=["as","children","className","content","fullWidth"],k.defaultProps={as:"thead"},k.propTypes={};var G=k;function y(e){var t=e.as,r=(0,f.Z)(y,e);return d.createElement(G,(0,u.Z)({},r,{as:t}))}y.handledProps=["as"],y.propTypes={},y.defaultProps={as:"tfoot"};var N=y;function _(e){var t=e.as,r=e.className,n=e.sorted,s=(0,h.Z)((0,v.cD)(n,"sorted"),r),a=(0,f.Z)(_,e);return d.createElement(A,(0,u.Z)({},a,{as:t,className:s}))}_.handledProps=["as","className","sorted"],_.propTypes={},_.defaultProps={as:"th"};var R=_;function C(e){var t=e.active,r=e.cellAs,n=e.cells,s=e.children,a=e.className,l=e.disabled,i=e.error,c=e.negative,o=e.positive,Z=e.textAlign,x=e.verticalAlign,b=e.warning,w=(0,h.Z)((0,v.lG)(t,"active"),(0,v.lG)(l,"disabled"),(0,v.lG)(i,"error"),(0,v.lG)(c,"negative"),(0,v.lG)(o,"positive"),(0,v.lG)(b,"warning"),(0,v.X4)(Z),(0,v.Ok)(x),a),j=(0,f.Z)(C,e),k=(0,g.Z)(C,e);return m.kK(s)?d.createElement(k,(0,u.Z)({},j,{className:w}),(0,p.Z)(n,(function(e){return A.create(e,{defaultProps:{as:r}})}))):d.createElement(k,(0,u.Z)({},j,{className:w}),s)}C.handledProps=["active","as","cellAs","cells","children","className","disabled","error","negative","positive","textAlign","verticalAlign","warning"],C.defaultProps={as:"tr",cellAs:"td"},C.propTypes={},C.create=(0,b.u5)(C,(function(e){return{cells:e}}));var P=C;function q(e){var t=e.attached,r=e.basic,n=e.celled,s=e.children,a=e.className,l=e.collapsing,i=e.color,c=e.columns,o=e.compact,Z=e.definition,b=e.fixed,w=e.footerRow,j=e.headerRow,A=e.headerRows,k=e.inverted,y=e.padded,_=e.renderBodyRow,R=e.selectable,C=e.singleLine,E=e.size,T=e.sortable,D=e.stackable,z=e.striped,B=e.structured,F=e.tableData,H=e.textAlign,L=e.unstackable,O=e.verticalAlign,S=(0,h.Z)("ui",i,E,(0,v.lG)(n,"celled"),(0,v.lG)(l,"collapsing"),(0,v.lG)(Z,"definition"),(0,v.lG)(b,"fixed"),(0,v.lG)(k,"inverted"),(0,v.lG)(R,"selectable"),(0,v.lG)(C,"single line"),(0,v.lG)(T,"sortable"),(0,v.lG)(D,"stackable"),(0,v.lG)(z,"striped"),(0,v.lG)(B,"structured"),(0,v.lG)(L,"unstackable"),(0,v.sU)(t,"attached"),(0,v.sU)(r,"basic"),(0,v.sU)(o,"compact"),(0,v.sU)(y,"padded"),(0,v.X4)(H),(0,v.Ok)(O),(0,v.H0)(c,"column"),"table",a),X=(0,f.Z)(q,e),I=(0,g.Z)(q,e);if(!m.kK(s))return d.createElement(I,(0,u.Z)({},X,{className:S}),s);var K={defaultProps:{cellAs:"th"}},U=(j||A)&&d.createElement(G,null,P.create(j,K),(0,p.Z)(A,(function(e){return P.create(e,K)})));return d.createElement(I,(0,u.Z)({},X,{className:S}),U,d.createElement(x,null,_&&(0,p.Z)(F,(function(e,t){return P.create(_(e,t))}))),w&&d.createElement(N,null,P.create(w)))}q.handledProps=["as","attached","basic","celled","children","className","collapsing","color","columns","compact","definition","fixed","footerRow","headerRow","headerRows","inverted","padded","renderBodyRow","selectable","singleLine","size","sortable","stackable","striped","structured","tableData","textAlign","unstackable","verticalAlign"],q.defaultProps={as:"table"},q.propTypes={},q.Body=x,q.Cell=A,q.Footer=N,q.Header=G,q.HeaderCell=R,q.Row=P;var E=q,T=r(967),D=r(6215),z=r(5789),B=r(4148),F=r(4111),H=r(4924),L=r(1508),O=function(e){(0,l.Z)(r,e);var t=(0,i.Z)(r);function r(){var e;(0,s.Z)(this,r),e=t.apply(this,arguments),(0,H.Z)((0,F.Z)(e),"state",{manager:"",account:"",loading:!1});var a=(0,F.Z)(e);(0,H.Z)((0,F.Z)(e),"onApprove",(0,n.Z)((function(){var e,t;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return event.preventDefault(),e=(0,B.Z)(a.props.address),a.setState({loading:!0}),[4,L.Z.eth.getAccounts()];case 1:return t=r.sent(),[4,e.methods.approveRequest(a.props.id).send({from:t[0]})];case 2:return r.sent(),Router.pushRoute("/campaigns/".concat(a.props.address,"/requests")),a.setState({loading:!1}),[2]}}))})));var l=(0,F.Z)(e);(0,H.Z)((0,F.Z)(e),"onFinalize",(0,n.Z)((function(){var e,t;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return event.preventDefault(),e=(0,B.Z)(l.props.address),l.setState({loading:!0}),[4,L.Z.eth.getAccounts()];case 1:return t=r.sent(),[4,e.methods.finalizeRequest(l.props.id).send({from:t[0]})];case 2:return r.sent(),Router.pushRoute("/campaigns/".concat(l.props.address,"/requests")),l.setState({loading:!1}),[2]}}))})));var i=(0,F.Z)(e);return(0,H.Z)((0,F.Z)(e),"managerAddress",(0,n.Z)((function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,B.Z)(i.props.address).methods.manager().call()];case 1:return[2,e.sent()]}}))}))),(0,H.Z)((0,F.Z)(e),"getAccounts",(0,n.Z)((function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,L.Z.eth.getAccounts()];case 1:return[2,e.sent()[0]]}}))}))),e}return(0,a.Z)(r,[{key:"componentDidMount",value:function(){var e=this;return(0,n.Z)((function(){var t,r;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return t=e.setState,r={},[4,e.managerAddress()];case 1:return r.manager=n.sent(),[4,e.getAccounts()];case 2:return t.apply(e,[(r.account=n.sent(),r)]),[2]}}))}))()}},{key:"render",value:function(){var e=E.Row,t=E.Cell,r=this.props,n=r.id,s=r.request,a=r.approversCount,l=this.state,i=l.manager,c=l.account,d=s.approvalCount>a/2;return(0,o.jsxs)(e,{disabled:s.complete,positive:d&&!s.complete,children:[(0,o.jsxs)(t,{children:[" ",n," "]}),(0,o.jsxs)(t,{children:[" ",s.description," "]}),(0,o.jsxs)(t,{children:[" ",L.Z.utils.fromWei(s.value,"ether")," "]}),(0,o.jsxs)(t,{children:[" ",s.recipient," "]}),(0,o.jsxs)(t,{children:[" ",s.approvalCount,"/",a," "]}),(0,o.jsx)(t,{children:s.complete?null:(0,o.jsx)(T.Z,{loading:this.state.loading,color:"green",basic:!0,onClick:this.onApprove,children:"Approve"})}),(0,o.jsx)(t,{children:s.complete||c!=i?null:(0,o.jsx)(T.Z,{loading:this.state.loading,color:"teal",basic:!0,onClick:this.onFinalize,children:"Finalize"})})]})}}],[{key:"getInitialProps",value:function(e){return(0,n.Z)((function(){return(0,c.__generator)(this,(function(t){return[2,{address:e.query.address}]}))}))()}}]),r}(d.Component),S=O,X=function(e){(0,l.Z)(r,e);var t=(0,i.Z)(r);function r(){return(0,s.Z)(this,r),t.apply(this,arguments)}return(0,a.Z)(r,[{key:"renderRows",value:function(){var e=this;return this.props.requests.map((function(t,r){return(0,o.jsx)(S,{id:r,request:t,address:e.props.address,approversCount:e.props.approversCount},r)}))}},{key:"render",value:function(){var e=E.Header,t=E.Row,r=E.HeaderCell,n=E.Body;return(0,o.jsxs)(z.Z,{children:[(0,o.jsx)(D.Link,{route:"/campaigns/".concat(this.props.address),children:(0,o.jsx)("a",{children:(0,o.jsx)(w.Z,{name:"angle left",children:"Back"})})}),(0,o.jsx)("h3",{children:"Requests"}),(0,o.jsx)(D.Link,{route:"/campaigns/".concat(this.props.address,"/requests/new"),children:(0,o.jsx)("a",{children:(0,o.jsx)(T.Z,{primary:!0,floated:"left",style:{marginBottom:12},children:"Add Request"})})}),(0,o.jsx)("div",{style:{width:"100%",height:"100%",overflow:"auto"},children:(0,o.jsxs)(E,{fluid:!0,children:[(0,o.jsx)(e,{children:(0,o.jsxs)(t,{children:[(0,o.jsx)(r,{children:"ID"}),(0,o.jsx)(r,{children:"Description"}),(0,o.jsx)(r,{children:"Amount"}),(0,o.jsx)(r,{children:"Recipient"}),(0,o.jsx)(r,{children:"Approval Count"}),(0,o.jsx)(r,{children:"Approve"}),(0,o.jsx)(r,{children:"Finalize"})]})}),(0,o.jsx)(n,{children:this.renderRows()})]})}),(0,o.jsxs)("div",{children:["Found ",this.props.requestCount," request(s)."]})]})}}],[{key:"getInitialProps",value:function(e){return(0,n.Z)((function(){var t,r,n,s,a;return(0,c.__generator)(this,(function(l){switch(l.label){case 0:return t=e.query.address,[4,(r=(0,B.Z)(t)).methods.getRequestsCount().call()];case 1:return n=l.sent(),[4,r.methods.approversCount().call()];case 2:return s=l.sent(),[4,Promise.all(Array(parseInt(n)).fill().map((function(e,t){return r.methods.requests(t).call()})))];case 3:return a=l.sent(),[2,{address:t,requests:a,requestCount:n,approversCount:s}]}}))}))()}}]),r}(d.Component),I=X}},function(e){e.O(0,[543,177,906,774,888,179],(function(){return t=8216,e(e.s=t);var t}));var t=e.O();_N_E=t}]);